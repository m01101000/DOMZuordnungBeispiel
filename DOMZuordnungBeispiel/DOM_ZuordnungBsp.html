<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>DOM-Zuordnung Beispiel</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.4.2/lib/p5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ml5@0.12.2/dist/ml5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .image { width: 200px; margin: 10px; }
        .spinner { display: none; color: red; font-weight: bold; }
        .container { display: flex; align-items: center; margin-bottom: 30px; }
    </style>
</head>
<body>

<h2>Beispiel: DOM-Zuordnung von Bild zu Klassifikation</h2>

<div class="container">
    <img class="image" src="image/peacock.jpg" alt="Bild 1">
    <div>
        <canvas class="chart" width="300" height="200"></canvas>
        <div id="spinner1" class="spinner">Lade...</div>
    </div>
</div>

<div class="container">
    <img class="image" src="image/ball.jpg" alt="Bild 2">
    <div>
        <canvas class="chart" width="300" height="200"></canvas>
        <div id="spinner2" class="spinner">Lade...</div>
    </div>
</div>

<script>
    const images = document.querySelectorAll('.image');
    const canvases = document.querySelectorAll('.chart');

    ml5.imageClassifier('MobileNet', () => {
        images.forEach((img, index) => {
            const spinner = document.getElementById(`spinner${index + 1}`);
            const canvas = canvases[index].getContext('2d');
            spinner.style.display = 'block';

            const classifier = ml5.imageClassifier('MobileNet', () => {
                classifier.classify(img, (err, results) => {
                    spinner.style.display = 'none';

                    const labels = results.slice(0, 3).map(r => r.label);
                    const scores = results.slice(0, 3).map(r => r.confidence);

                    new Chart(canvas, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Wahrscheinlichkeit',
                                data: scores
                            }]
                        },
                        options: {
                            responsive: false,
                            scales: {
                                y: { beginAtZero: true }
                            }
                        }
                    });
                });
            });
        });
    });
</script>
</body>
</html>